<!DOCTYPE html>
<html lang="en"
    class="antialiased text-gray-900 bg-white dark:bg-black dark:text-gray-100 selection:bg-gray-200 dark:selection:bg-gray-800">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FiniteDiffrence - The Rest Frame</title>

    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&display=swap"
        rel="stylesheet">

    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'media',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['-apple-system', 'BlinkMacSystemFont', '"SF Pro Display"', '"SF Pro Text"', 'Helvetica Neue', 'Arial', 'sans-serif'],
                        serif: ['"IBM Plex Serif"', 'Georgia', 'serif'],
                    }
                }
            }
        }
    </script>

    
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>

    
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

    <style type="text/tailwindcss">
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            @apply bg-gray-300 dark:bg-gray-700 rounded-full border-2 border-transparent bg-clip-padding;
        }
        ::-webkit-scrollbar-thumb:hover {
            @apply bg-gray-400 dark:bg-gray-600;
        }

        .markdown-content h1 {
            @apply text-4xl sm:text-5xl font-bold tracking-tight mb-8 mt-12 text-gray-900 dark:text-white;
        }

        .markdown-content h2 {
            @apply text-2xl sm:text-3xl font-bold tracking-tight mb-6 mt-10 text-gray-900 dark:text-white;
        }

        .markdown-content h3 {
            @apply text-xl sm:text-2xl font-semibold tracking-tight mb-4 mt-8 text-gray-900 dark:text-white;
        }

        .markdown-content p {
            @apply text-[1.05rem] md:text-lg leading-relaxed mb-6 text-gray-800 dark:text-gray-300 text-justify;
        }

        .markdown-content a {
            @apply text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 underline underline-offset-2;
        }

        .markdown-content ul {
            @apply list-disc list-outside ml-6 mb-6 text-lg text-gray-700 dark:text-gray-300 space-y-2;
        }

        .markdown-content ol {
            @apply list-decimal list-outside ml-6 mb-6 text-lg text-gray-700 dark:text-gray-300 space-y-2;
        }

        .markdown-content blockquote {
            @apply border-l-4 border-gray-300 dark:border-gray-700 pl-5 pr-5 py-2 mb-8 text-lg md:text-xl text-gray-600 dark:text-gray-400 italic bg-gray-50 dark:bg-gray-900 rounded-r-lg;
        }

        .markdown-content img {
            @apply shadow-sm my-8 mx-auto ring-1 ring-gray-200 dark:ring-gray-800;
        }

        .markdown-content code:not(pre code) {
            @apply bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-200 px-1.5 py-0.5 rounded-md font-mono text-sm break-words;
        }

        .markdown-content pre {
            @apply bg-[#282c34] rounded-lg shadow-sm overflow-x-auto p-4 mb-8 ring-1 ring-gray-200 dark:ring-gray-800;
        }

        .markdown-content pre code {
            @apply text-sm leading-relaxed text-gray-300 bg-transparent p-0 border-0;
        }

         
        .markdown-content mjx-container[display="true"] { 
            @apply overflow-x-auto overflow-y-hidden max-w-full block py-4;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", "Helvetica Neue", Arial, sans-serif;
            -webkit-font-smoothing: antialiased;
        }
    </style>
</head>

<body class="min-h-screen flex flex-col">
    <header
        class="sticky top-0 z-50 bg-white/90 dark:bg-black/90 backdrop-blur-md border-b border-gray-100 dark:border-gray-800 transition-all">
        <div class="max-w-4xl mx-auto px-6 py-4 flex flex-wrap justify-between items-center w-full gap-4">
            <a href="/" class="text-xl font-bold tracking-tight text-gray-900 dark:text-white">
                The Rest Frame
            </a>
            <nav class="flex gap-6 text-[0.9rem] font-medium text-gray-500 dark:text-gray-400">
                <a href="/" class="hover:text-gray-900 dark:hover:text-white transition-colors">Home</a>
                <a href="/timeline.html"
                    class="hover:text-gray-900 dark:hover:text-white transition-colors">Timeline</a>
                <a href="/tags.html" class="hover:text-gray-900 dark:hover:text-white transition-colors">Tags</a>
                <a href="/about.html" class="hover:text-gray-900 dark:hover:text-white transition-colors">About</a>
            </nav>
        </div>
    </header>

    <main class="flex-grow w-full max-w-4xl mx-auto px-6 py-12 sm:py-16">
        
<article class="animate-in fade-in">
    <header class="mb-10 sm:mb-14 text-left max-w-3xl mx-auto">
        <h1
            class="text-4xl sm:text-5xl md:text-6xl font-black tracking-tight mb-6 text-gray-900 dark:text-white leading-tight">
            FiniteDiffrence
        </h1>

        <div class="flex flex-wrap items-center gap-4 text-sm font-semibold text-gray-500 dark:text-gray-400">
            <time datetime="2024-12-10" class="flex items-center gap-1.5">
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z">
                    </path>
                </svg>
                2024-12-10
            </time>

            
            <div class="hidden sm:block text-gray-300 dark:text-gray-600">•</div>
            <div class="flex flex-wrap gap-2">
                
                <a href="/tags/Article.html"
                    class="inline-flex items-center text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors">
                    #Article
                </a>
                
                <a href="/tags/physics.html"
                    class="inline-flex items-center text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors">
                    #physics
                </a>
                
            </div>
            

            <div class="hidden sm:block text-gray-300 dark:text-gray-600">•</div>
            <div class="flex items-center gap-1.5 text-gray-600 dark:text-gray-300">
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
                Shyam Sunder
            </div>
        </div>
    </header>

    
    <div class="max-w-4xl mx-auto mb-10 sm:mb-14">
        <img src="//assets/finite-difference_1.png" alt="FiniteDiffrence" class="w-full h-auto object-cover rounded-lg">
    </div>
    

    <hr class="my-8 border-gray-100 dark:border-gray-800/80">

    <div class="markdown-content max-w-[85ch] mx-auto text-[1.05rem] md:text-lg">
        <p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h2>Shyam Sunder</h2>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
import math
from scipy.sparse import diags
</code></pre>
<p>Let <span class="math inline">\(y = y(x)\)</span> be a function of x.
<!-- raw HTML omitted -->
Then we know from taylor's series:</p>
<p><span class="math display">\[y(x+h) = y(x) + hy'(x) + h^2y''(x) + \cdots
\]</span></p>
<p><span class="math display">\[y(x-h) = y(x) - hy'(x) + h^2y''(x) - \cdots
\]</span></p>
<p>Substracting these two we get:</p>
<p><span class="math display">\[y(x+h)-y(x-h)=2hy'(x) + \mathcal{O}(h^3)
\]</span></p>
<p><span class="math display">\[y'(x) = \frac{y(x+h)-y(x-h)}{2h} + \mathcal{O}(h^3)
\]</span></p>
<blockquote>
<p>This is called <strong>Central Difference Formula for diffrentiation.</strong></p>
</blockquote>
<p>By adding these two, we get</p>
<p><span class="math display">\[y"(x) = \frac{y(x+h)+y(x-h)-2y(x)}{h^2} + \mathcal{O}(h^4)
\]</span></p>
<p>In context of any diffrential equation, We are given boundries <span class="math inline">\(x_0\)</span> to <span class="math inline">\(X_n\)</span>. So we can simply devide it into N equal parts deffering by h. Let <span class="math inline">\(x_i = x_0 + ih\)</span> represent a point in this intevel. So <span class="math inline">\(y_i = y(x_i)\)</span>. We can write the equation:</p>
<p><span class="math display">\[y''(x) = \frac{y_{i+1} + y_{i-1} - 2y_{i}}{h^2}
\]</span></p>
<p>and also:</p>
<p><span class="math display">\[y'(x) = \frac{y_{i+1}-y_i}{h}
\]</span></p>
<p>We want to solve the boundry value problem:</p>
<p><span class="math display">\[\frac{d^2 y}{dx^2} -\frac{dy}{dx} - 2y = cos(x)
\]</span></p>
<p><span class="math display">\[y(0) = -0.3 \quad y(\pi/2)= -0.1
\]</span></p>
<p><span class="math display">\[0 \leq x \leq \frac{\pi}{2} 
\]</span></p>
<p>We can break the interval <span class="math inline">\([0, \frac{\pi}{2}]\)</span> into <span class="math inline">\(n\)</span> parts and label them with is where
<span class="math inline">\(x_i = 0 + ih\)</span> and <span class="math inline">\(h\)</span> is the diffrence bewteen two terms.</p>
<p>We can write the \autoref{pro} as:</p>
<p><span class="math display">\[y" - y' - 2y = \cos(x)
\]</span></p>
<p>When we apply the finite diffrence method we get:</p>
<p><span class="math display">\[\frac{y_{i+1} + y_{i-1} - 2y_{i}}{h^2} -  \frac{y_{i+1}-y_i}{h} - 2y_i = \cos(x_i)
\]</span></p>
<p>Now we will put some values of i:</p>
<p><span class="math display">\[y_0 = -0.3 \quad \quad i =0 
\]</span></p>
<p><span class="math display">\[\frac{1}{h^2}\left( 1.y_{0} + (-2h^2+h-2)y_1 + (1-h)y_{2}\right)  = \cos(x_1) \quad i = 1
\]</span></p>
<p><span class="math display">\[\frac{1}{h^2}\left( 1.y_{1} + (-2h^2+h-2)y_2 + (1-h)y_{3}\right)  = \cos(x_2) \quad i = 2
\]</span></p>
<p><span class="math inline">\(\vdots\)</span></p>
<p><span class="math display">\[\frac{1}{h^2}\left( 1.y_{i-1} + (-2h^2+h-2)y_{i} + (1-h)y_{i+1}\right)  = \cos(x_i) \quad i = i
\]</span></p>
<p><span class="math inline">\(\vdots\)</span></p>
<p><span class="math display">\[\frac{1}{h^2}\left( 1.y_{n-2} + (-2h^2+h-2)y_{n-1} + (1-h)y_{n}\right)  = \cos(x_{n-1}) \quad i = n-1
\]</span></p>
<p><span class="math display">\[y_n = -0.1
\]</span></p>
<p>We can Represent this in the Matrix forms as</p>
<p><span class="math display">\[    \frac{1}{h^2}
    \begin{bmatrix}
        h^2 & 0 & 0 & \cdots & 0 & 0 \\
        1 & -2+h-2h^2 & 1-h  &\cdots & 0 & 0 \\
        0 & 1 &  -2+h-2h^2   &\cdots & 0 & 0 \\
        \vdots & \vdots & & & & \vdots \\
        0 & 0 & 0 & \cdots & -2+h-2h^2 & 1-h \\
        0 & 0 & 0 & \cdots & 0 & h^2 
    \end{bmatrix}
    \begin{bmatrix}
        y_0 \\
        y_1 \\
        y_2 \\ 
        \vdots \\
        y_{n-1} \\
        y_n
    \end{bmatrix} =
    \begin{bmatrix}
        -0.3 \\
        \cos(x_1) \\
        \cos(x_2) \\
        \vdots \\
        \cos(x_{n-1}) \\
        -0.1
    \end{bmatrix}
\]</span></p>
<p><span class="math display">\[MY = b
\]</span></p>
<pre><code class="language-python">pi = math.pi
xs = np.linspace(0, math.pi/2,100)
h = np.diff(xs)[0] #size of each step
N = xs.size #number of steps
</code></pre>
<p>To desging the M matrix we would take a different approach. I will design the diagoals of the matrix sperately and then I will put them into a empty matrix using diag.</p>
<pre><code class="language-python">#desging the diagonals of the matrix
d1 = np.ones(N-1)
d0 = (-2+h-2*h**2)*np.ones(N)
d3 = (1-h)*np.ones(N-1)

# d1 = np.ones(N-1)
# d0 = -2*np.ones(N)
# d3 = d1

#Putting the dignoals into a empty matrix
M = diags([d1,d0,d3],[-1,0,1]).toarray()

#multiplying by 1/h^2 fector
M = (1/h**2)*M

#putting in the boundry Coditions
M[0][0]=1
M[0][1]=0
M[-1][-1]=1
M[-1][-2] = 0
</code></pre>
<pre><code class="language-python">#desing the left matrix
b = np.zeros(N)
for i in range(len(b)):
    b[i] = math.cos(xs[i])
b[0]=-0.3
b[-1]=-0.1
</code></pre>
<p>We will use the gaussian elimination method to solve the equation</p>
<pre><code class="language-python">def gaussianElimination(A, B):
    n = len(A)
    A = np.c_[A, B]
    
    #getting echilion matrix:
    for i in range(n):
        for j in range(i+1,n):
            fector = A[j][i]/A[i][i]
            for k in range(i, n+1):
                A[j][k] -= A[i][k]*fector

    c = [0 for _ in B]        
    #backSubstitution
    string = ''
    for i in range(n-1,-1,-1):
        sum = 0
        for j in range(i,n):
            sum += A[i][j]*c[j]
        c[i] = (A[i][-1] -sum)/A[i][i]
        
    return c
</code></pre>
<pre><code class="language-python">ys = gaussianElimination(M,b)
</code></pre>
<pre><code class="language-python">plt.plot(xs, ys, label='From fintie Difference Method')
plt.plot((0,pi/2),(-.3,-.1), '*')
plt.legend()
plt.show()
</code></pre>
<p><img src="/assets/FiniteDiffrence-1.png" alt="png"></p>
<p>The Theoritical solution for this problem is:</p>
<p><span class="math display">\[y(x) = \frac{1}{10}(-\sin(x)-3\cos(x))
\]</span></p>
<pre><code class="language-python">def theory(x):
    return (1/10)*(-math.sin(x)-3*math.cos(x))
</code></pre>
<pre><code class="language-python">y_th = [theory(x) for x in xs]
</code></pre>
<pre><code class="language-python">plt.plot(xs, ys, label='From fintie Difference Method')
plt.plot(xs, y_th, label='From Theory')
plt.plot((0,pi/2),(-.3,-.1), '*')
plt.legend()
plt.show()
</code></pre>
<p><img src="/assets/FiniteDiffrence-2.png" alt="png"></p>
<p>So as we can see that our solution exactly matches with the theorictical value</p>

    </div>
</article>

    </main>

    <footer class="py-10 border-t border-gray-100 dark:border-gray-900 mt-auto text-center">
        <div class="max-w-4xl mx-auto px-6">
            <p class="text-[0.8rem] text-gray-400 dark:text-gray-500">
                &copy; 2026 The Rest Frame.
            </p>
        </div>
    </footer>
</body>

</html>